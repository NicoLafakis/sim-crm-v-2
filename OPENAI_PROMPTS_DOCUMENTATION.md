# OpenAI Prompts Documentation for SimCRM

This document provides a comprehensive list of all prompts being sent to the OpenAI models in the SimCRM application. The system uses OpenAI's GPT models to generate realistic CRM data based on themes and industries.

## Overview

The SimCRM application uses OpenAI's chat completions API to generate realistic data for CRM simulations. All prompts consist of:
- **System message**: Theme and industry-specific context
- **User message**: Action-specific instructions with JSON schema requirements
- **Response format**: JSON objects only
- **Models used**: Primary model `gpt-5-nano`, fallback model `gpt-5-nano` (both currently the same)

## System Prompt

The system prompt is generated by the `getSystemPrompt()` function and is consistent across all API calls:

```typescript
function getSystemPrompt(theme: string, industry: string): string {
  return `You are an expert CRM data generator for the SimCRM application. Generate realistic and appropriate data that fits the "${theme}" theme in the ${industry} industry context.

IMPORTANT: All generated content must align with the "${theme}" theme. Use names, companies, job titles, and terminology that would fit naturally within this theme. Be creative but consistent.

Respond with valid JSON only. Follow the exact schema requirements and ensure all required fields are present with the correct data types.`;
}
```

**Example system prompt for Star Wars theme in Demo industry:**
```
You are an expert CRM data generator for the SimCRM application. Generate realistic and appropriate data that fits the "Star Wars" theme in the demo industry context.

IMPORTANT: All generated content must align with the "Star Wars" theme. Use names, companies, job titles, and terminology that would fit naturally within this theme. Be creative but consistent.

Respond with valid JSON only. Follow the exact schema requirements and ensure all required fields are present with the correct data types.
```

## User Prompts by Action Type

All user prompts are generated by the `createLLMPrompt()` function based on the action type. The base prompt format is:

```
Generate appropriate {action_type} data for a {theme}-themed {industry} simulation that maintains internal consistency.
```

### 1. Create Contact (`create_contact`)

**Base prompt:**
```
Generate appropriate create contact data for a {theme}-themed {industry} simulation that maintains internal consistency. You MUST return complete contact data in valid JSON format. Include ALL required fields with realistic values:
      
Example expected output:
{
  "firstName": "John",
  "lastName": "Smith", 
  "email": "john.smith@techcorp.com",
  "phone": "+1-555-123-4567",
  "jobTitle": "Software Engineer",
  "company": "TechCorp Inc"
}
      
Generate a complete contact that fits the {theme} theme with ALL these fields populated.
```

**Example for Star Wars theme:**
```
Generate appropriate create contact data for a Star Wars-themed demo simulation that maintains internal consistency. You MUST return complete contact data in valid JSON format. Include ALL required fields with realistic values:
      
Example expected output:
{
  "firstName": "John",
  "lastName": "Smith", 
  "email": "john.smith@techcorp.com",
  "phone": "+1-555-123-4567",
  "jobTitle": "Software Engineer",
  "company": "TechCorp Inc"
}
      
Generate a complete contact that fits the Star Wars theme with ALL these fields populated.
```

### 2. Create Company (`create_company`)

**Base prompt:**
```
Generate appropriate create company data for a {theme}-themed {industry} simulation that maintains internal consistency. You MUST return complete company data in valid JSON format. Include ALL required fields with realistic values:
      
Example expected output:
{
  "name": "TechCorp Inc",
  "domain": "techcorp.com", 
  "city": "San Francisco",
  "state": "California",
  "industry": "Software",
  "numberofemployees": 150
}
      
Generate a complete company that fits the {theme} theme with ALL these fields populated.
```

### 3. Create Deal (`create_deal`)

**Base prompt (without CRM metadata):**
```
Generate appropriate create deal data for a {theme}-themed {industry} simulation that maintains internal consistency. You MUST return complete deal data in valid JSON format. Include ALL required fields with realistic values.

Example expected output:
{"dealname": "Enterprise Software License", "amount": 25000, "dealstage": "appointmentscheduled", "pipeline": "default"}

DO NOT modify or append anything to these exact values.
```

**With CRM metadata:**
```
Generate appropriate create deal data for a {theme}-themed {industry} simulation that maintains internal consistency. You MUST return complete deal data in valid JSON format. Include ALL required fields with realistic values.

IMPORTANT - Use ONLY these exact pipeline and stage IDs from the target CRM:
{getDealPipelineOptions(crmMetadata)}

DO NOT append any suffixes, seeds, or random values to the pipeline/stage IDs.

Example expected output:
{"dealname": "Enterprise Software License", "amount": 25000, "dealstage": "[USE_EXACT_STAGE_ID]", "pipeline": "[USE_EXACT_PIPELINE_ID]"}
```

### 4. Create Note (`create_note`)

**Base prompt:**
```
Generate appropriate create note data for a {theme}-themed {industry} simulation that maintains internal consistency. Create a professional note body that fits the {theme}. Keep it under 200 characters. Return JSON with: {"hs_note_body": ""}
```

**Enhanced prompt for Demo Mode with examples:**
```
Generate appropriate create note data for a {theme}-themed demo simulation that maintains internal consistency. Create a professional note body that fits the {theme}. Keep it under 200 characters. Return JSON with: {"hs_note_body": ""}

For context, here are some example scenarios from this demo simulation:
• {demoDetailsSample1}
• {demoDetailsSample2}
• {demoDetailsSample3}
• {demoDetailsSample4}
• {demoDetailsSample5}
• {demoDetailsSample6}

Use these as inspiration for realistic content that fits the {theme} theme.
```

### 5. Create Ticket (`create_ticket`)

**Base prompt (without CRM metadata):**
```
Generate appropriate create ticket data for a {theme}-themed {industry} simulation that maintains internal consistency. Create a support ticket with subject and content that fits the {theme}. Return JSON with: {"subject": "", "content": "", "hs_pipeline_stage": "1", "hs_pipeline": "0"}
```

**With CRM metadata:**
```
Generate appropriate create ticket data for a {theme}-themed {industry} simulation that maintains internal consistency. Create a support ticket with subject and content that fits the {theme}.

IMPORTANT - Use ONLY these exact pipeline and stage IDs from the target CRM:
{getTicketPipelineOptions(crmMetadata)}

Return JSON with: {"subject": "", "content": "", "hs_pipeline_stage": "[USE_EXACT_STAGE_ID]", "hs_pipeline": "[USE_EXACT_PIPELINE_ID]"}
```

**Enhanced prompt for Demo Mode with examples:**
```
Generate appropriate create ticket data for a {theme}-themed demo simulation that maintains internal consistency. Create a support ticket with subject and content that fits the {theme}. Return JSON with: {"subject": "", "content": "", "hs_pipeline_stage": "1", "hs_pipeline": "0"}

For context, here are some example scenarios from this demo simulation:
• {demoDetailsSample1}
• {demoDetailsSample2}
• {demoDetailsSample3}
• {demoDetailsSample4}
• {demoDetailsSample5}
• {demoDetailsSample6}

Use these as inspiration for realistic content that fits the {theme} theme.
```

### 6. Update Deal (`update_deal`)

**Base prompt (without CRM metadata):**
```
Generate appropriate update deal data for a {theme}-themed {industry} simulation that maintains internal consistency. Create data to update a deal that fits the {theme} theme. Return JSON with stage update: {"dealstage": "closedwon"}

DO NOT modify or append anything to these exact values.
```

**With CRM metadata:**
```
Generate appropriate update deal data for a {theme}-themed {industry} simulation that maintains internal consistency. Create data to update a deal that fits the {theme} theme.

IMPORTANT - Use ONLY these exact stage IDs from the target CRM:
{getDealPipelineOptions(crmMetadata)}

DO NOT append any suffixes, seeds, or random values to the stage IDs.

Return JSON with stage update: {"dealstage": "[USE_EXACT_STAGE_ID]"}
```

### 7. Update Ticket (`update_ticket`)

**Base prompt (without CRM metadata):**
```
Generate appropriate update ticket data for a {theme}-themed {industry} simulation that maintains internal consistency. Create data to update a support ticket that fits the {theme} theme. Return JSON with: {"hs_pipeline_stage": "2"}
```

**With CRM metadata:**
```
Generate appropriate update ticket data for a {theme}-themed {industry} simulation that maintains internal consistency. Create data to update a support ticket that fits the {theme} theme.

IMPORTANT - Use ONLY these exact stage IDs from the target CRM:
{getTicketPipelineOptions(crmMetadata)}

Return JSON with: {"hs_pipeline_stage": "[USE_EXACT_STAGE_ID]"}
```

### 8. Close Ticket (`close_ticket`)

**Base prompt (without CRM metadata):**
```
Generate appropriate close ticket data for a {theme}-themed {industry} simulation that maintains internal consistency. Create data to close a support ticket. Return JSON with: {"hs_pipeline_stage": "3"}
```

**With CRM metadata:**
```
Generate appropriate close ticket data for a {theme}-themed {industry} simulation that maintains internal consistency. Create data to close a support ticket.

IMPORTANT - Use ONLY these exact stage IDs that represent "closed" status from the target CRM:
{getTicketPipelineOptions(crmMetadata)}

Return JSON with: {"hs_pipeline_stage": "[USE_EXACT_CLOSED_STAGE_ID]"}
```

### 9. Default/Fallback

**Base prompt:**
```
Generate appropriate {action_type} data for a {theme}-themed {industry} simulation that maintains internal consistency. Generate appropriate data in JSON format.
```

## Prompt Enhancements

### Seeded Generation

When seeded generation is enabled (controlled by the `useSeed` parameter), the system appends deterministic seeding instructions to any user prompt:

```typescript
static createSeededPrompt(basePrompt: string, seed: string): string {
  return `${basePrompt}\n\nIMPORTANT: Use this seed for consistent generation: ${seed}. Generate the same realistic data every time for this seed.`;
}
```

**Example seeded prompt:**
```
Generate appropriate create contact data for a Star Wars-themed demo simulation that maintains internal consistency. You MUST return complete contact data in valid JSON format. Include ALL required fields with realistic values:
      
Example expected output:
{
  "firstName": "John",
  "lastName": "Smith", 
  "email": "john.smith@techcorp.com",
  "phone": "+1-555-123-4567",
  "jobTitle": "Software Engineer",
  "company": "TechCorp Inc"
}
      
Generate a complete contact that fits the Star Wars theme with ALL these fields populated.

IMPORTANT: Use this seed for consistent generation: a1b2c3d4. Generate the same realistic data every time for this seed.
```

### Demo Mode Context Enhancement

For Demo Mode simulations, when creating notes or tickets, the system adds context from CSV simulation details to provide realistic examples:

```typescript
if (industry === 'demo' && demoDetailsSamples && demoDetailsSamples.length > 0 && 
    (actionType.includes('note') || actionType.includes('ticket'))) {
  const sampleDetails = demoDetailsSamples.slice(0, 6).join('\n• ');
  enhancedPrompt += `\n\nFor context, here are some example scenarios from this demo simulation:\n• ${sampleDetails}\n\nUse these as inspiration for realistic content that fits the ${theme} theme.`;
}
```

## API Call Structure

Each OpenAI API call follows this structure:

```typescript
await openai.chat.completions.create({
  model: "gpt-5-nano",
  messages: [
    {
      role: "system",
      content: getSystemPrompt(theme, industry)
    },
    {
      role: "user",
      content: enhancedPrompt
    }
  ],
  response_format: { type: "json_object" }
});
```

## Error Handling and Fallback

- **Primary Model**: `gpt-5-nano`
- **Fallback Model**: `gpt-5-nano` (currently same as primary)
- **Retry Logic**: Implemented with rate limiting and exponential backoff
- **Response Format**: Always expects JSON objects
- **Validation**: Generated data is validated against Zod schemas

## Models Used

- **Primary**: `gpt-5-nano`
- **Fallback**: `gpt-5-nano`
- **Rate Limiting**: Applied through custom rate limiter with retry logic
- **Response Format**: JSON objects only

## Summary

The SimCRM application uses a sophisticated prompt generation system that:

1. **Generates contextual system prompts** based on theme and industry
2. **Creates action-specific user prompts** with detailed JSON schema requirements
3. **Supports seeded generation** for consistent results
4. **Enhances prompts with demo context** when appropriate
5. **Implements robust error handling** with fallback models
6. **Validates all generated content** against predefined schemas

All prompts are designed to generate realistic, theme-consistent CRM data while maintaining strict JSON format requirements and schema compliance.